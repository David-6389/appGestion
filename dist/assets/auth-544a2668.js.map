{"version":3,"file":"auth-544a2668.js","sources":["../../scripts/auth.js"],"sourcesContent":["// auth.js - Lógica de autenticación de usuarios\r\nimport { supabase } from './supabase.js';\r\n\r\n// Función para mostrar alertas (copiada de app.js para usarla aquí)\r\nfunction mostrarAlerta(mensaje, tipo = 'info') {\r\n    const alertContainer = document.getElementById('alertContainer');\r\n    if (!alertContainer) return;\r\n\r\n    const alerta = document.createElement('div');\r\n    alerta.className = `alert alert-${tipo} alert-dismissible fade show`;\r\n    alerta.innerHTML = `\r\n        ${mensaje}\r\n        <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"alert\"></button>\r\n    `;\r\n    alertContainer.appendChild(alerta);\r\n\r\n    setTimeout(() => alerta.remove(), 5000);\r\n}\r\n\r\n// --- MANEJADOR DE LOGIN ---\r\nconst loginForm = document.getElementById('login-form');\r\nif (loginForm) {\r\n    loginForm.addEventListener('submit', async (e) => {\r\n        e.preventDefault();\r\n        const email = document.getElementById('login-email').value;\r\n        const password = document.getElementById('login-password').value;\r\n\r\n        const { error } = await supabase.auth.signInWithPassword({\r\n            email: email,\r\n            password: password,\r\n        });\r\n\r\n        if (error) {\r\n            mostrarAlerta(`Error: ${error.message}`, 'danger');\r\n        } else {\r\n            // Redirigir a la página principal si el login es exitoso\r\n            window.location.href = '/index.html';\r\n        }\r\n    });\r\n}\r\n\r\n// --- MANEJADOR DE SIGNUP ---\r\nconst signupForm = document.getElementById('signup-form');\r\nif (signupForm) {\r\n    signupForm.addEventListener('submit', async (e) => {\r\n        e.preventDefault();\r\n        const email = document.getElementById('signup-email').value;\r\n        const password = document.getElementById('signup-password').value;\r\n\r\n        const { data, error } = await supabase.auth.signUp({\r\n            email: email,\r\n            password: password,\r\n        });\r\n\r\n        if (error) {\r\n            mostrarAlerta(`Error: ${error.message}`, 'danger');\r\n        } else {\r\n            if (data.user && data.user.identities && data.user.identities.length === 0) {\r\n                 mostrarAlerta('Este usuario ya existe. Intenta iniciar sesión.', 'warning');\r\n            } else {\r\n                 mostrarAlerta('¡Registro exitoso! Revisa tu email para confirmar tu cuenta.', 'success');\r\n                 // Opcional: redirigir a una página de \"revisa tu email\" o al login\r\n                 setTimeout(() => {\r\n                    window.location.href = '/login.html';\r\n                 }, 3000);\r\n            }\r\n        }\r\n    });\r\n}\r\n\r\nfunction configurarVisualizacionPassword() {\r\n    // Configurar para login\r\n    \r\n    const toggleLoginBtn = document.getElementById('toggleLoginPassword');\r\n    const loginPassword = document.getElementById('login-password');\r\n    \r\n    if (toggleLoginBtn && loginPassword) {\r\n        toggleLoginBtn.addEventListener('click', function() {\r\n            togglePasswordVisibility(loginPassword, toggleLoginBtn);\r\n        });\r\n    }\r\n    \r\n    // Configurar para registro\r\n    const toggleSignupBtn = document.getElementById('toggleSignupPassword');\r\n    const registerPassword = document.getElementById('signup-password');\r\n    \r\n    if (toggleSignupBtn && registerPassword) {\r\n        toggleSignupBtn.addEventListener('click', function() {\r\n            togglePasswordVisibility(registerPassword, toggleSignupBtn);\r\n        });\r\n    }\r\n    \r\n    // Configurar para confirmar contraseña\r\n    const toggleConfirmBtn = document.getElementById('toggleConfirmPassword');\r\n    const confirmPassword = document.getElementById('confirm-password');\r\n    \r\n    if (toggleConfirmBtn && confirmPassword) {\r\n        toggleConfirmBtn.addEventListener('click', function() {\r\n            togglePasswordVisibility(confirmPassword, toggleConfirmBtn);\r\n        });\r\n    }\r\n}\r\n\r\n// Función auxiliar para cambiar la visibilidad\r\nfunction togglePasswordVisibility(passwordInput, toggleButton) {\r\n    const isPassword = passwordInput.type === 'password';\r\n    \r\n    if (isPassword) {\r\n        // Mostrar contraseña\r\n        passwordInput.type = 'text';\r\n        toggleButton.innerHTML = '<i class=\"bi bi-eye\"></i>';\r\n        toggleButton.setAttribute('aria-label', 'Ocultar contraseña');\r\n    } else {\r\n        // Ocultar contraseña\r\n        passwordInput.type = 'password';\r\n        toggleButton.innerHTML = '<i class=\"bi bi-eye-slash\"></i>';\r\n        toggleButton.setAttribute('aria-label', 'Mostrar contraseña');\r\n    }\r\n}\r\n\r\ndocument.addEventListener('DOMContentLoaded', configurarVisualizacionPassword);"],"names":["mostrarAlerta","mensaje","tipo","alertContainer","alerta","loginForm","e","email","password","error","supabase","signupForm","data","configurarVisualizacionPassword","toggleLoginBtn","loginPassword","togglePasswordVisibility","toggleSignupBtn","registerPassword","toggleConfirmBtn","confirmPassword","passwordInput","toggleButton"],"mappings":"2CAIA,SAASA,EAAcC,EAASC,EAAO,OAAQ,CAC3C,MAAMC,EAAiB,SAAS,eAAe,gBAAgB,EAC/D,GAAI,CAACA,EAAgB,OAErB,MAAMC,EAAS,SAAS,cAAc,KAAK,EAC3CA,EAAO,UAAY,eAAeF,CAAI,+BACtCE,EAAO,UAAY;AAAA,UACbH,CAAO;AAAA;AAAA,MAGbE,EAAe,YAAYC,CAAM,EAEjC,WAAW,IAAMA,EAAO,OAAQ,EAAE,GAAI,CAC1C,CAGA,MAAMC,EAAY,SAAS,eAAe,YAAY,EAClDA,GACAA,EAAU,iBAAiB,SAAU,MAAOC,GAAM,CAC9CA,EAAE,eAAc,EAChB,MAAMC,EAAQ,SAAS,eAAe,aAAa,EAAE,MAC/CC,EAAW,SAAS,eAAe,gBAAgB,EAAE,MAErD,CAAE,MAAAC,CAAO,EAAG,MAAMC,EAAS,KAAK,mBAAmB,CACrD,MAAOH,EACP,SAAUC,CACtB,CAAS,EAEGC,EACAT,EAAc,UAAUS,EAAM,OAAO,GAAI,QAAQ,EAGjD,OAAO,SAAS,KAAO,aAEnC,CAAK,EAIL,MAAME,EAAa,SAAS,eAAe,aAAa,EACpDA,GACAA,EAAW,iBAAiB,SAAU,MAAOL,GAAM,CAC/CA,EAAE,eAAc,EAChB,MAAMC,EAAQ,SAAS,eAAe,cAAc,EAAE,MAChDC,EAAW,SAAS,eAAe,iBAAiB,EAAE,MAEtD,CAAE,KAAAI,EAAM,MAAAH,CAAK,EAAK,MAAMC,EAAS,KAAK,OAAO,CAC/C,MAAOH,EACP,SAAUC,CACtB,CAAS,EAEGC,EACAT,EAAc,UAAUS,EAAM,OAAO,GAAI,QAAQ,EAE7CG,EAAK,MAAQA,EAAK,KAAK,YAAcA,EAAK,KAAK,WAAW,SAAW,EACpEZ,EAAc,kDAAmD,SAAS,GAE1EA,EAAc,+DAAgE,SAAS,EAEvF,WAAW,IAAM,CACd,OAAO,SAAS,KAAO,aACzB,EAAE,GAAI,EAGxB,CAAK,EAGL,SAASa,GAAkC,CAGvC,MAAMC,EAAiB,SAAS,eAAe,qBAAqB,EAC9DC,EAAgB,SAAS,eAAe,gBAAgB,EAE1DD,GAAkBC,GAClBD,EAAe,iBAAiB,QAAS,UAAW,CAChDE,EAAyBD,EAAeD,CAAc,CAClE,CAAS,EAIL,MAAMG,EAAkB,SAAS,eAAe,sBAAsB,EAChEC,EAAmB,SAAS,eAAe,iBAAiB,EAE9DD,GAAmBC,GACnBD,EAAgB,iBAAiB,QAAS,UAAW,CACjDD,EAAyBE,EAAkBD,CAAe,CACtE,CAAS,EAIL,MAAME,EAAmB,SAAS,eAAe,uBAAuB,EAClEC,EAAkB,SAAS,eAAe,kBAAkB,EAE9DD,GAAoBC,GACpBD,EAAiB,iBAAiB,QAAS,UAAW,CAClDH,EAAyBI,EAAiBD,CAAgB,CACtE,CAAS,CAET,CAGA,SAASH,EAAyBK,EAAeC,EAAc,CACxCD,EAAc,OAAS,YAItCA,EAAc,KAAO,OACrBC,EAAa,UAAY,4BACzBA,EAAa,aAAa,aAAc,oBAAoB,IAG5DD,EAAc,KAAO,WACrBC,EAAa,UAAY,kCACzBA,EAAa,aAAa,aAAc,oBAAoB,EAEpE,CAEA,SAAS,iBAAiB,mBAAoBT,CAA+B"}